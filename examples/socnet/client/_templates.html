<!-- ====================================== -->
<!-- user_avatar                            -->
<!-- -------------------------------------- -->
<!-- params:                                -->
<!--   user: User                           -->
<!-- ====================================== -->
<template name="user_avatar">
{{#if user}}
  <!-- <img src="/images/gnuhead.png" width="45"/> -->
  <!-- <img src="/images/{{this.user.name}}.jpg" width="45"/> -->
  <img {{editableField obj=user fld="avatar"}} src="{{user.avatarLink}}" width="45" height="45"/>
{{else}}
  <img src="/images/anonymous-50x50.png" width="45" height="45"/>
{{/if}}
</template>

<!-- ====================================== -->
<!-- _user                                  -->
<!-- -------------------------------------- -->
<!-- params:                                -->
<!--   user: User                           -->
<!--   avatar: Bool                         -->
<!--   status: Bool                         -->
<!--   editableName: Bool                   -->
<!-- ====================================== -->
<template name="_user">
    <div class="User list-group-item {{#if isMe this.user}}me{{/if}}">
      {{#if avatar}}
        {{> user_avatar user=user}}
      {{/if}}
      <div class="user-name-status">
        {{#if editableName}}
          <h4 class="list-group-item-heading"
              {{editableField obj=this.user fld="name"}}>
            {{salute this.user}}
          </h4>
        {{else}}
          <h4 class="list-group-item-heading">{{salute this.user}}</h4>
        {{/if}}
        {{#if status}}
          <p class="list-group-item-text">
            <a {{editableField obj=this.user fld="status"}}>{{this.user.statusText}}</a>
          </p>
        {{/if}}
      </div>
    </div>
</template>

<!-- ====================================== -->
<!-- network_by_users                       -->
<!-- -------------------------------------- -->
<!-- params:                                -->
<!--   user: User                           -->
<!-- ====================================== -->
<template name="network_by_users">
  <ul class="list-inline">
  {{#each user.network.groupByRange}}
  <li style="margin: 1px">
    <div class="inlineb top">{{> user_avatar user=this.key}}</div>
    <div class="inlineb top">
      <div>
        <span class="friend_name">{{this.key.name}}</span> (<span class="friend_email">{{this.key.email}}</span>)
      </div>
      <div>
        {{#each this.value}}<span class="friend_kind label label-primary">{{this.first}}</span>{{/each}}
      </div>
    </div>
  </li>
  {{/each}}
  </ul>
</template>

<!-- ====================================== -->
<!-- users_profile                          -->
<!-- -------------------------------------- -->
<!-- params:                                -->
<!--   user: User                           -->
<!-- ====================================== -->
<template name="user_profile">
  <div class="row user_profile_top">
    {{> user_avatar user=user}}
    <div class="user_info">
      <span id="profile_name" {{editableField obj=user fld="name"}}>{{salute user}}</span><br>
      <span {{editableField obj=user fld="email"}}><i class="icon-envelope"></i>&nbsp;{{user.email}}</span><br>
      <span {{editableField obj=user fld="location"}}><i class="icon-globe"></i>&nbsp;{{user.location}}</span>
    </div>
    <div class="user_status">
      <div class="status_label">Status:</div>
      <span id="profile_status" {{editableField obj=user fld="status"}}>{{user.statusText}}</span><br>
    </div>
  </div>
  <div class="row user_profile_bottom">
    <div class="user_network">
      <div class="network_label">Network ({{user.network.groupByRange.length}})</div>
      {{> network_by_users user=user}}
    </div>
    <div class="user_wall">
      <div class="wall_label">Wall</div>
      <div {{PostEvent to=user}}>
        <textarea class="form-control" rows="2" {{PostEvent_text}}></textarea>
        <button class="btn btn-primary" {{sunny_trigger}}>Post</button>
      </div>
      <div class="posts">
        {{#each user.wall}}
        <div class="post">
          <div class="post_date">
            Posted on: {{this.timeFormatted}} by {{this.author.name}}
            <span class="delete_post glyphicon glyphicon-remove"
                  {{Destroy obj=this}} {{sunny_trigger}}
                  ></span>
          </div>
          <div class="post_author">{{> user_avatar user=this.author}}</div>
          <div class="post_body">
          {{#each body}}
            {{#if isText}}
              <span class="text_chunk">{{this.text}}</span>
            {{/if}}
            {{#if isUserTag}}
              <span class="inline_user">{{> user_avatar user=this.user}}</span>
            {{/if}}
            {{#if isHashTag}}
              <span class="label label-warn inline_hashtag">{{this.tag}}</span>
            {{/if}}
          {{/each}}          
          </div>
          <div class="post_tags"></div>
          <div class="post_peeps"></div>
        </div>
        {{/each}}
      </div>
    </div>
  </div>
</template>

<!-- ====================================== -->
<!-- friend_groups                          -->
<!-- -------------------------------------- -->
<!-- params:                                -->
<!-- ====================================== -->
<template name="friend_groups">
  <div class="inlineb online-users">
    <h3>Me</h3>
    <div class="friendUserDiv" {{SelectUser user=Client.user}} {{sunny_trigger}}>
      {{> _user user=Client.user status=true avatar=true}}
    </div>
    <h3>My Network</h3>
    <ul class="networkTreeOuter">
    {{#each Client.user.network.groupByDomain}}
      <li class="outer">{{key}}</li>
      <ul>
        {{#each value}}
        <li class="inner">
          <div class="friendUserDiv" {{SelectUser user=this.last}} {{sunny_trigger}}>
            {{> _user user=this.last status=true avatar=true}}
          </div>
          <span class="editRelBtn glyphicon glyphicon-plus"
                {{AddToMyNetwork kind=_prompt_ user=this.last}}
                {{sunny_trigger}}
                ></span>
          <span class="removeRelBtn glyphicon glyphicon-remove"
                {{RemoveMyRel kind=../key user=this.last}}
                {{sunny_trigger}}></span>
        </li>
        {{/each}}
      </ul>
    {{/each}}
    </ul>
  </div>
</template>


<!-- ====================================== -->
<!-- other_users                            -->
<!-- -------------------------------------- -->
<!-- params:                                -->
<!-- ====================================== -->
<template name="other_users">
  <div class="inlineb online-users">
    <h3>Add User</h3>
    <input type="text" class="search-query" placeholder="enter user name or email"
           {{AddToMyNetwork kind="friends"}} {{AddToMyNetwork_userName}} {{sunny_trigger}}>
  </div>
</template>
